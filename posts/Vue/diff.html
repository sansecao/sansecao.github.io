<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>diff 算法 | shirley&#39; blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="Stay hungry, Stay foolish!">
    
    <link rel="preload" href="/assets/css/0.styles.f1147152.css" as="style"><link rel="preload" href="/assets/js/app.2b3c16d9.js" as="script"><link rel="preload" href="/assets/js/2.4bbb4ca5.js" as="script"><link rel="preload" href="/assets/js/6.14ed718f.js" as="script"><link rel="preload" href="/assets/js/10.40a72b24.js" as="script"><link rel="preload" href="/assets/js/32.3194c25a.js" as="script"><link rel="prefetch" href="/assets/js/100.e2d86fce.js"><link rel="prefetch" href="/assets/js/101.87d96723.js"><link rel="prefetch" href="/assets/js/102.45425e42.js"><link rel="prefetch" href="/assets/js/103.6af0e127.js"><link rel="prefetch" href="/assets/js/104.b4ab661c.js"><link rel="prefetch" href="/assets/js/105.5b617b43.js"><link rel="prefetch" href="/assets/js/106.ea384279.js"><link rel="prefetch" href="/assets/js/107.8125dc24.js"><link rel="prefetch" href="/assets/js/108.a18789e8.js"><link rel="prefetch" href="/assets/js/109.83a54884.js"><link rel="prefetch" href="/assets/js/11.cba0d063.js"><link rel="prefetch" href="/assets/js/12.b586c683.js"><link rel="prefetch" href="/assets/js/13.95964f08.js"><link rel="prefetch" href="/assets/js/14.c4135cc5.js"><link rel="prefetch" href="/assets/js/15.759a9198.js"><link rel="prefetch" href="/assets/js/16.59652573.js"><link rel="prefetch" href="/assets/js/17.61dcc6c1.js"><link rel="prefetch" href="/assets/js/18.68f43013.js"><link rel="prefetch" href="/assets/js/19.4a5eb9e0.js"><link rel="prefetch" href="/assets/js/20.75adf05c.js"><link rel="prefetch" href="/assets/js/21.b6833a90.js"><link rel="prefetch" href="/assets/js/22.90f21f7c.js"><link rel="prefetch" href="/assets/js/23.bc860dea.js"><link rel="prefetch" href="/assets/js/24.52386a5a.js"><link rel="prefetch" href="/assets/js/25.a0cb6fb9.js"><link rel="prefetch" href="/assets/js/26.511c5795.js"><link rel="prefetch" href="/assets/js/27.56ab9bfa.js"><link rel="prefetch" href="/assets/js/28.19378e6f.js"><link rel="prefetch" href="/assets/js/29.9d9ad706.js"><link rel="prefetch" href="/assets/js/3.7f35d7f4.js"><link rel="prefetch" href="/assets/js/30.2496cc1d.js"><link rel="prefetch" href="/assets/js/31.4ec1976d.js"><link rel="prefetch" href="/assets/js/33.4dd0ea1f.js"><link rel="prefetch" href="/assets/js/34.ba80214e.js"><link rel="prefetch" href="/assets/js/35.a38f77bd.js"><link rel="prefetch" href="/assets/js/36.e27e57ff.js"><link rel="prefetch" href="/assets/js/37.48a59729.js"><link rel="prefetch" href="/assets/js/38.cb6d26cb.js"><link rel="prefetch" href="/assets/js/39.3f26aea9.js"><link rel="prefetch" href="/assets/js/4.12f5ba8e.js"><link rel="prefetch" href="/assets/js/40.1418b91e.js"><link rel="prefetch" href="/assets/js/41.92b09304.js"><link rel="prefetch" href="/assets/js/42.903e83f0.js"><link rel="prefetch" href="/assets/js/43.755dd2d1.js"><link rel="prefetch" href="/assets/js/44.422c6a31.js"><link rel="prefetch" href="/assets/js/45.98f773d9.js"><link rel="prefetch" href="/assets/js/46.21568ddd.js"><link rel="prefetch" href="/assets/js/47.af720435.js"><link rel="prefetch" href="/assets/js/48.57441751.js"><link rel="prefetch" href="/assets/js/49.bc061280.js"><link rel="prefetch" href="/assets/js/5.6914d8cd.js"><link rel="prefetch" href="/assets/js/50.5d0486bf.js"><link rel="prefetch" href="/assets/js/51.e9e4bbab.js"><link rel="prefetch" href="/assets/js/52.714d60d4.js"><link rel="prefetch" href="/assets/js/53.01b53e3b.js"><link rel="prefetch" href="/assets/js/54.57b2a2d0.js"><link rel="prefetch" href="/assets/js/55.e2fee879.js"><link rel="prefetch" href="/assets/js/56.80e20210.js"><link rel="prefetch" href="/assets/js/57.4f0588e3.js"><link rel="prefetch" href="/assets/js/58.d578fa6b.js"><link rel="prefetch" href="/assets/js/59.10fb9f7b.js"><link rel="prefetch" href="/assets/js/60.11bb2c9c.js"><link rel="prefetch" href="/assets/js/61.0d11383a.js"><link rel="prefetch" href="/assets/js/62.1efb443f.js"><link rel="prefetch" href="/assets/js/63.e245d2cc.js"><link rel="prefetch" href="/assets/js/64.de76c297.js"><link rel="prefetch" href="/assets/js/65.271eea5c.js"><link rel="prefetch" href="/assets/js/66.04fea32b.js"><link rel="prefetch" href="/assets/js/67.13f49c25.js"><link rel="prefetch" href="/assets/js/68.85f7eee2.js"><link rel="prefetch" href="/assets/js/69.f3c52202.js"><link rel="prefetch" href="/assets/js/7.093c7dfd.js"><link rel="prefetch" href="/assets/js/70.b759c9c6.js"><link rel="prefetch" href="/assets/js/71.3c4ff64d.js"><link rel="prefetch" href="/assets/js/72.56f01204.js"><link rel="prefetch" href="/assets/js/73.df93a151.js"><link rel="prefetch" href="/assets/js/74.0a5629eb.js"><link rel="prefetch" href="/assets/js/75.a4e4581d.js"><link rel="prefetch" href="/assets/js/76.bd44f6a7.js"><link rel="prefetch" href="/assets/js/77.55317c5e.js"><link rel="prefetch" href="/assets/js/78.06d92cbc.js"><link rel="prefetch" href="/assets/js/79.c19a4ae3.js"><link rel="prefetch" href="/assets/js/8.03fdccde.js"><link rel="prefetch" href="/assets/js/80.283e9c1c.js"><link rel="prefetch" href="/assets/js/81.b5b11067.js"><link rel="prefetch" href="/assets/js/82.7e51ba1c.js"><link rel="prefetch" href="/assets/js/83.61351b1c.js"><link rel="prefetch" href="/assets/js/84.319edb79.js"><link rel="prefetch" href="/assets/js/85.22d7e042.js"><link rel="prefetch" href="/assets/js/86.c92c69db.js"><link rel="prefetch" href="/assets/js/87.306caa13.js"><link rel="prefetch" href="/assets/js/88.89b971eb.js"><link rel="prefetch" href="/assets/js/89.e1b69329.js"><link rel="prefetch" href="/assets/js/9.d4cdc2c8.js"><link rel="prefetch" href="/assets/js/90.0dcee3bb.js"><link rel="prefetch" href="/assets/js/91.1e4dbd51.js"><link rel="prefetch" href="/assets/js/92.b4b58e03.js"><link rel="prefetch" href="/assets/js/93.83f15204.js"><link rel="prefetch" href="/assets/js/94.8c1185ea.js"><link rel="prefetch" href="/assets/js/95.c60baccb.js"><link rel="prefetch" href="/assets/js/96.a35a69b4.js"><link rel="prefetch" href="/assets/js/97.b4801ac2.js"><link rel="prefetch" href="/assets/js/98.e3b41fb8.js"><link rel="prefetch" href="/assets/js/99.9663b909.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f1147152.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">shirley' blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Posts" class="dropdown-title"><span class="title">Posts</span> <span class="arrow down"></span></button> <button type="button" aria-label="Posts" class="mobile-dropdown-title"><span class="title">Posts</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/posts/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/posts/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/posts/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/posts/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/posts/ES6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/posts/Vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/posts/nodeJS/" class="nav-link">
  nodeJS
</a></li><li class="dropdown-item"><!----> <a href="/posts/MySql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/posts/TypeScript/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/posts/react/" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/posts/internet/" class="nav-link">
  internet
</a></li><li class="dropdown-item"><!----> <a href="/posts/MicroFE/" class="nav-link">
  MicroFrontends
</a></li><li class="dropdown-item"><!----> <a href="/posts/tool/" class="nav-link">
  tool
</a></li><li class="dropdown-item"><!----> <a href="/posts/question/" class="nav-link">
  question
</a></li><li class="dropdown-item"><!----> <a href="/posts/Browser/" class="nav-link">
  浏览器
</a></li></ul></div></div><div class="nav-item"><a href="/essay/" class="nav-link">
  Essay
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Posts" class="dropdown-title"><span class="title">Posts</span> <span class="arrow down"></span></button> <button type="button" aria-label="Posts" class="mobile-dropdown-title"><span class="title">Posts</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/posts/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/posts/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/posts/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/posts/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/posts/ES6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/posts/Vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/posts/nodeJS/" class="nav-link">
  nodeJS
</a></li><li class="dropdown-item"><!----> <a href="/posts/MySql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/posts/TypeScript/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/posts/react/" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/posts/internet/" class="nav-link">
  internet
</a></li><li class="dropdown-item"><!----> <a href="/posts/MicroFE/" class="nav-link">
  MicroFrontends
</a></li><li class="dropdown-item"><!----> <a href="/posts/tool/" class="nav-link">
  tool
</a></li><li class="dropdown-item"><!----> <a href="/posts/question/" class="nav-link">
  question
</a></li><li class="dropdown-item"><!----> <a href="/posts/Browser/" class="nav-link">
  浏览器
</a></li></ul></div></div><div class="nav-item"><a href="/essay/" class="nav-link">
  Essay
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/posts/Vue/" aria-current="page" class="sidebar-link">Vue</a></li><li><a href="/posts/Vue/vue初始化项目.html" class="sidebar-link">使用脚手架初始化项目</a></li><li><a href="/posts/Vue/axios.html" class="sidebar-link">Axios 在 Vue 中的使用</a></li><li><a href="/posts/Vue/vue-router的两种mode.html" class="sidebar-link">vue-router</a></li><li><a href="/posts/Vue/keep-alive.html" class="sidebar-link">keep-alive</a></li><li><a href="/posts/Vue/mixins.html" class="sidebar-link">mixins</a></li><li><a href="/posts/Vue/自定义指令.html" class="sidebar-link">自定义指令</a></li><li><a href="/posts/Vue/diff.html" aria-current="page" class="active sidebar-link">diff 算法</a></li><li><a href="/posts/Vue/nextTick.html" class="sidebar-link">vue的nextTick</a></li><li><a href="/posts/Vue/vue中学习的问题.html" class="sidebar-link">vue 中好的问题</a></li><li><a href="/posts/Vue/vue面试问题.html" class="sidebar-link">vue面试问题</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>nodeJS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mysql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>internet</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MicroFrontends</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>tool</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>question</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="diff-算法"><a href="#diff-算法" class="header-anchor">#</a> diff 算法</h1> <h2 id="_1-当数据发生变化时-vue-是怎么样更新节点的"><a href="#_1-当数据发生变化时-vue-是怎么样更新节点的" class="header-anchor">#</a> 1. 当数据发生变化时，vue 是怎么样更新节点的？</h2> <p>渲染真是 DOM 的开销是非常大的，比如有些时候我们修改了某个数据，如果直接渲染到真是的 dom 树上会引起整个 dom 树的重绘和重排，但是我们理想状态只是需要一小块的 dom 更新</p> <p>virtual DOM：先根据真是的 dom 树生成一棵虚拟的 dom 树，当 virtual DOM 某个节点的数据改变后会生成一个新的 Vnode。然后 Vnode 和 oldVnode 做对比，发现不一样的地方就直接修改真是的 dom 上，然后 oldVnode 的值为 Vnode</p> <p>实际上，diff 的过程就是调用 patch 的函数，比较新旧节点，一边比较一边给真实的 dom 打补丁</p> <h2 id="_2-virtual-dom-和真实的-dom-的区别"><a href="#_2-virtual-dom-和真实的-dom-的区别" class="header-anchor">#</a> 2. virtual DOM 和真实的 DOM 的区别</h2> <ol><li>virtual DOM 的表现</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> Vnode <span class="token operator">=</span> <span class="token punctuation">{</span>
  tag<span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">{</span> tag<span class="token operator">:</span> <span class="token string">'p'</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">'123'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="2"><li>真实的 DOM</li></ol> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_3-diff-的比较方式"><a href="#_3-diff-的比较方式" class="header-anchor">#</a> 3. diff 的比较方式</h2> <p>看虚拟的 dom 中的结构就知道，diff 的比较只会在同层级进行比较，不会跨层级进行比较</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>根据上面的代码，比较同一层的两个 div 以及第二层的 p 和 span，但是不会拿 div 和 span 进行比较，如下图的成对比较的情况：</p> <p><img src="/assets/img/diff1.861e0452.png" alt="图解"></p> <h2 id="_4-diff-的流程图"><a href="#_4-diff-的流程图" class="header-anchor">#</a> 4. diff 的流程图</h2> <p><img src="/assets/img/diff2.6bb48865.png" alt="图解"></p> <h2 id="patch-方法"><a href="#patch-方法" class="header-anchor">#</a> patch 方法</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// some code</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> oEl <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>el<span class="token punctuation">;</span> <span class="token comment">// 当前oldVnode对应的真实元素节点</span>
    <span class="token keyword">let</span> parentEle <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">parentNode</span><span class="token punctuation">(</span>oEl<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 父元素</span>
    <span class="token function">createEle</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 根据Vnode生成新元素</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>parentEle <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentEle<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>el<span class="token punctuation">,</span> api<span class="token punctuation">.</span><span class="token function">nextSibling</span><span class="token punctuation">(</span>oEl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将新元素添加进父元素</span>
      api<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>parentEle<span class="token punctuation">,</span> oldVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 移除以前的旧元素节点</span>
      oldVnode <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// some code</span>
  <span class="token keyword">return</span> vnode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>先判断是否值得去比较这个节点，如果值得去比较的话，如果值得比较的话执行 patchVnode（值得比较说明这个节点没有改变，如果改变了直接替换掉旧节点）
不值得比较的话直接替换掉 oldVnode</p> <p>那么有一个问题，如果父节点不一样，子节点之后的全部一样呢？这种情况会直接替换父节点，在 diff 也有一种数据单向流，上级修改了下级不管是否修改都会直接上级替换</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sameVnode</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    a<span class="token punctuation">.</span>key <span class="token operator">===</span> b<span class="token punctuation">.</span>key <span class="token operator">&amp;&amp;</span> <span class="token comment">// key值</span>
    a<span class="token punctuation">.</span>tag <span class="token operator">===</span> b<span class="token punctuation">.</span>tag <span class="token operator">&amp;&amp;</span> <span class="token comment">// 标签名</span>
    a<span class="token punctuation">.</span>isComment <span class="token operator">===</span> b<span class="token punctuation">.</span>isComment <span class="token operator">&amp;&amp;</span> <span class="token comment">// 是否为注释节点</span>
    <span class="token comment">// 是否都定义了data，data包含一些具体信息，例如onclick , style</span>
    <span class="token function">isDef</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">isDef</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
    <span class="token function">sameInputType</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token comment">// 当标签是&lt;input&gt;的时候，type必须相同</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>如果两个节点值得去比较的时候 patchVnode 方式是什么呢？</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">patchVnode</span> <span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> el <span class="token operator">=</span> vnode<span class="token punctuation">.</span>el <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>el
    <span class="token keyword">let</span> i<span class="token punctuation">,</span> oldCh <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>children<span class="token punctuation">,</span> ch <span class="token operator">=</span> vnode<span class="token punctuation">.</span>children
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode <span class="token operator">===</span> vnode<span class="token punctuation">)</span> <span class="token keyword">return</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> vnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> oldVnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> vnode<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        api<span class="token punctuation">.</span><span class="token function">setTextContent</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">updateEle</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> oldVnode<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCh <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&amp;&amp;</span> oldCh <span class="token operator">!==</span> ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">updateChildren</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">createEle</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span> <span class="token comment">//create el's children dom</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCh<span class="token punctuation">)</span><span class="token punctuation">{</span>
            api<span class="token punctuation">.</span><span class="token function">removeChildren</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>实际上 patchVnode 需要完成的事情是：</p> <ol><li>找到对应真是的 dom---&gt;el</li> <li>判断 Vnode 和 oldVnode 是否指向同一个对象，如果是，就是没有改变</li> <li>如果是文本且文本不一样，赋值</li> <li>如果 oldVnode 有子节点而 Vnode 没有，直接删除子节点</li> <li>如果 oldVnode 没有子节点，而 Vnode 有，则将 Vnode 真实化之后添加到 el</li> <li>如果都有子节点，执行 updateChildren 函数比较子节点</li></ol> <p>可想而知道上面的 1-&gt;5 都是比较好实现，但是第 6 点想想都是一个恶心的过程</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">updateChildren</span> <span class="token punctuation">(</span><span class="token parameter">parentElm<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> newCh</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> oldStartIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> newStartIdx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> oldEndIdx <span class="token operator">=</span> oldCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">let</span> oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>oldEndIdx<span class="token punctuation">]</span>
    <span class="token keyword">let</span> newEndIdx <span class="token operator">=</span> newCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">let</span> newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIdx<span class="token punctuation">]</span>
    <span class="token keyword">let</span> oldKeyToIdx
    <span class="token keyword">let</span> idxInOld
    <span class="token keyword">let</span> elmToMove
    <span class="token keyword">let</span> before
    <span class="token keyword">while</span> <span class="token punctuation">(</span>oldStartIdx <span class="token operator">&lt;=</span> oldEndIdx <span class="token operator">&amp;&amp;</span> newStartIdx <span class="token operator">&lt;=</span> newEndIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldStartVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// 对于vnode.key的比较，会把oldVnode = null</span>
            oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldEndVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newStartVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newEndVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span>
            oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span>
            newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span>
            oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span>
            newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span>
            api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">,</span> api<span class="token punctuation">.</span><span class="token function">nextSibling</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span><span class="token punctuation">)</span>
            oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span>
            newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span>
            api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldEndVnode<span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
            oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span>
            newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
           <span class="token comment">// 使用key时的比较</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>oldKeyToIdx <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                oldKeyToIdx <span class="token operator">=</span> <span class="token function">createKeyToOldIdx</span><span class="token punctuation">(</span>oldCh<span class="token punctuation">,</span> oldStartIdx<span class="token punctuation">,</span> oldEndIdx<span class="token punctuation">)</span> <span class="token comment">// 有key生成index表</span>
            <span class="token punctuation">}</span>
            idxInOld <span class="token operator">=</span> oldKeyToIdx<span class="token punctuation">[</span>newStartVnode<span class="token punctuation">.</span>key<span class="token punctuation">]</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>idxInOld<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> <span class="token function">createEle</span><span class="token punctuation">(</span>newStartVnode<span class="token punctuation">)</span><span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                elmToMove <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>idxInOld<span class="token punctuation">]</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>elmToMove<span class="token punctuation">.</span>sel <span class="token operator">!==</span> newStartVnode<span class="token punctuation">.</span>sel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> <span class="token function">createEle</span><span class="token punctuation">(</span>newStartVnode<span class="token punctuation">)</span><span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">patchVnode</span><span class="token punctuation">(</span>elmToMove<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span>
                    oldCh<span class="token punctuation">[</span>idxInOld<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
                    api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> elmToMove<span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldStartIdx <span class="token operator">&gt;</span> oldEndIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        before <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> newCh<span class="token punctuation">[</span>newEndIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>el
        <span class="token function">addVnodes</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> before<span class="token punctuation">,</span> newCh<span class="token punctuation">,</span> newStartIdx<span class="token punctuation">,</span> newEndIdx<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newStartIdx <span class="token operator">&gt;</span> newEndIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">removeVnodes</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> oldStartIdx<span class="token punctuation">,</span> oldEndIdx<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><p>先解释这个函数做了什么</p> <ol><li>将 Vnode 的子节点 Vch 和 oldVnode 的子节点 oldCh 提取出来</li> <li>oldCh 和 vCh 各有两个变量，StartInx 和 EndIdx，他们的两个变量相互比较，一共 4 中比较方式，如果 4 种比较都没有匹配，如果设置了 key，就用 key 比较，在比较的过程中，变量会往中间靠，一旦 StartIdx &gt; EndIdx 表明 oldCH 至少有一个已经遍历完了，结束比较</li></ol> <p><font color="red">单看代码，容易睡着，建议先看图解，弄懂什么原理之后再去看代码</font></p> <p>红色为 oldCh 和 vCh：</p> <p><img src="data:image/png;base64,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" alt="图解"></p> <p>把他们提取出来跟别用 s 和 e 表示头 child 和尾 child</p> <p><img src="data:image/png;base64,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" alt="图解"></p> <p>现在分别对 oldS、oldE、S、E 两两做 sameVnode 比较，有四种比较方式，当其中两个能够匹配上那么真实 dom 中的相应节点会移到 Vnode 相应的位置</p> <ul><li>如果是 oldS 和 E 匹配上了，那么真是 dom 中的第一个节点会移到最后</li> <li>如果 oldE 和 S 匹配上了，那么真实 dom 中的最后一个节点移到最前，匹配上的两个指针向中间移动</li> <li>如果四种匹配没有一对成功的，那么遍历 oldChild，S 挨个和他们匹配，匹配成功旧再真实 dom 将成功移到最前面，如果没有成功，那么旧插入到 dom 中的 oldS 的位置，oldS 和 S 指针向中间移动</li></ul> <p><img src="data:image/png;base64,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" alt="图解"></p> <ol><li>第一步</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>oldS <span class="token operator">=</span> a<span class="token punctuation">;</span>
oldE <span class="token operator">=</span> d<span class="token punctuation">;</span>
<span class="token constant">S</span> <span class="token operator">=</span> a<span class="token punctuation">;</span>
<span class="token constant">E</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>oldS 和 S 匹配，则将 dom 中的 a 节点放到第一个，已经是第一个了就不管了，此时 dom 的位置为：a b d</p> <ol start="2"><li>第二步</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>oldS <span class="token operator">=</span> b<span class="token punctuation">;</span>
oldE <span class="token operator">=</span> d<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token constant">S</span> <span class="token operator">=</span> c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">E</span> <span class="token operator">=</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>oldS 和 E 匹配，就将原本的 b 节点移动到最后，因为 E 是最后一个节点，他们位置要一致，这就是上面说的：当其中两个能匹配上那么真实 dom 中的相应节点会移到 Vnode 相应的位置，此时 dom 的位置为：a d b</p> <ol start="3"><li>第三步</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>oldS <span class="token operator">=</span> d<span class="token punctuation">;</span>
oldE <span class="token operator">=</span> d<span class="token punctuation">;</span>
<span class="token constant">S</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
<span class="token constant">E</span> <span class="token operator">=</span> d<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>oldE 和 E 匹配，位置不变此时 dom 的位置为：a d b</p> <ol start="4"><li>第四步</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>oldS<span class="token operator">++</span><span class="token punctuation">;</span>
oldE<span class="token operator">--</span><span class="token punctuation">;</span>
oldS <span class="token operator">&gt;</span> oldE<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>遍历结束，说明 oldCh 先遍历完。就将剩余的 vCh 节点根据自己的的 index 插入到真实 dom 中去，此时 dom 位置为：a c d b</p> <p>这个匹配过程的结束有两个条件</p> <ul><li>oldS &gt; oldE 表示 oldCh 先遍历完，那么就将多余的 vCh 根据 index 添加到 dom 中去（如上图）</li> <li>S &gt; E 表示 vCh 先遍历完，那么就在真实 dom 中将区间为[oldS, oldE]的多余节点删掉</li></ul> <p><img src="/assets/img/diff6.0e8b782a.png" alt="图解"></p> <p><img src="data:image/png;base64,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" alt="图解"></p> <section class="back-to-top"><div class="rocket"><img src="/assets/img/backtotop.88303690.svg"></div></section> <div id="gitalk-container" class="gitask"></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">1/15/2021, 8:30:05 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/posts/Vue/自定义指令.html" class="prev">
        自定义指令
      </a></span> <span class="next"><a href="/posts/Vue/nextTick.html">
        vue的nextTick
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2b3c16d9.js" defer></script><script src="/assets/js/2.4bbb4ca5.js" defer></script><script src="/assets/js/6.14ed718f.js" defer></script><script src="/assets/js/10.40a72b24.js" defer></script><script src="/assets/js/32.3194c25a.js" defer></script>
  </body>
</html>
